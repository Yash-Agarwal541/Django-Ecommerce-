{% extends 'base.html' %}
{% block content %}
<div class="container mt-3">
  <div class="row">
  
    <!-- LEFT COLUMN: All items stacked -->
    <div class="col-sm-6">
      {% if items %}
        {% for item in items %}
          <div class="product-cart card mb-3">
            <div class="row">
              <div class="col-sm-3 text-center">
                <img class="product-cart-image" src="{{ item.product_image.url }}">
              </div>
              <div class="col-sm-3 text-center">
                <p class="product-cart-name">{{ item.slug }}</p>
              </div>
              <div class="col-sm-3 text-center">
                <div class = "row">
                  <div class="col-sm-12" >
                    <div class = "row">
                      <div class="col-sm-3 text-center"><a href="{% url 'remove_from_cart' item.slug %}?next={% url 'cart' %}" class="btn btn-danger border rounded mt-3">−</a></div>
                      <div class = "col-sm-5"><p class="product-cart-quantity">{{ item.product_quantity }}</p></div>
                      <div class = "col-sm-3"><a href="{% url 'add_cart' item.slug %}?next={% url 'cart' %}" class="btn btn-success border rounded mt-3">+</a>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="col-sm-3 text-center">
                <p class="product-cart-value">{{ item.total_cart_value }}</p>
              </div>
            </div>
          </div>
        {% endfor %}
      {% else %}
        <p>No items in cart.</p>
      {% endif %}
    </div>

    <!-- RIGHT COLUMN: Cart Summary -->
    <div class="col-sm-6">
      <div class="cart-desc card">
        <div class="text-center">
          <h2>Your Shopping Cart</h2>
        </div>
        <hr>
        <div class="row mt-3">
          <div class="col text-center">
            <h3>Total Value</h3>
          </div>
          <div class="col text-center">
            <h3>₹ {{total}}</h3> <!-- Replace with {{ total }} -->
          </div>
        </div>
        <div class="row mt-3 mb-3">
          <div class="col text-center">
            {% comment %} <a href="#"><button class="cart-desc-btn btn btn-secondary">Pay Now</button></a> {% endcomment %}
            <form class action = "{%url 'razorpay_payment'%}" method="post">
              {% csrf_token %}
              <button type="submit" class="cart-desc-btn btn btn-primary">Pay Now</button>
              </form>
          </div>
        </div>
      </div>
    </div>

  </div>
</div>
{% endblock %}
